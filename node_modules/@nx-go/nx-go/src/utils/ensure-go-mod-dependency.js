"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ensureGoModDependency = void 0;
const devkit_1 = require("@nrwl/devkit");
const constants_1 = require("./constants");
/**
 * Ensures that go.mod is an implicit dependency so that changes to go.mod triggers
 * projects to be flagged as affected
 */
function ensureGoModDependency(tree) {
    var _a;
    if (!tree.exists(constants_1.GO_MOD_FILE)) {
        return;
    }
    const workspaceConfig = (0, devkit_1.readWorkspaceConfiguration)(tree);
    const dependencies = (_a = workspaceConfig.implicitDependencies) !== null && _a !== void 0 ? _a : {};
    if (!dependencies[constants_1.GO_MOD_FILE]) {
        dependencies[constants_1.GO_MOD_FILE] = '*';
        workspaceConfig.implicitDependencies = dependencies;
        (0, devkit_1.updateWorkspaceConfiguration)(tree, workspaceConfig);
    }
}
exports.ensureGoModDependency = ensureGoModDependency;
//# sourceMappingURL=ensure-go-mod-dependency.js.map