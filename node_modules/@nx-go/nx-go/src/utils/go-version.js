"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.isVersionAfter = exports.getGoVersion = void 0;
const child_process_1 = require("child_process");
const GO_VERSION_REGEX = /go(?<version>\S+) /;
function getGoVersion() {
    const output = (0, child_process_1.execSync)('go version');
    if (output) {
        return GO_VERSION_REGEX.exec(output.toString()).groups.version;
    }
    else {
        throw new Error('Fail to retrieve Go version');
    }
}
exports.getGoVersion = getGoVersion;
function versionAsNum(version) {
    return parseInt(version) || 0;
}
function isVersionAfter(version, refVersion) {
    const [sMajor, sMinor, sPatch] = version.split('.');
    const [sRefMajor, sRefMinor, sRefPatch] = refVersion.split('.');
    const major = versionAsNum(sMajor);
    const refMajor = versionAsNum(sRefMajor);
    if (major != refMajor) {
        return major > refMajor;
    }
    const minor = versionAsNum(sMinor);
    const refMinor = versionAsNum(sRefMinor);
    if (minor != refMinor) {
        return minor > refMinor;
    }
    const patch = versionAsNum(sPatch);
    const refPatch = versionAsNum(sRefPatch);
    return patch >= refPatch;
}
exports.isVersionAfter = isVersionAfter;
//# sourceMappingURL=go-version.js.map